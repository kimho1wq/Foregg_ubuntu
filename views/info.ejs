<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>ForEgg - MY PAGE</title>

		<!-- CSS -->
		<link href="../css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/product.css" rel="stylesheet">
	</head>
	<body class="d-flex vh-100 bg-light">
		<div class="container px-3 py-5 m-auto" style="max-width: 28rem;">
			<img class="mb-5" src="../img/cs256.png" alt="" width="96" height="96">
			<h3 class="mb-3 font-weight-normal">USER INFO</h3>
			
            <form action="/users/info" method="post" enctype="multipart/form-data">
				<hr class="my-4">
				<div class="form-group">
                    <p>프로필 사진 선택</p>
                    <input type="file" class="form-control-file" id="profile_picture" name="profile_picture">
                </div>
                <button type="submit" class="btn btn-primary btn-block">프로필 사진 수정하기</button>
			</form>
            <form id="sign-in-form" action="#">
				<hr class="my-4">
				<div class="form-group">
                    <p>핸드폰 번호</p>
                    <input type="text" class="form-control" id="profile_phone" name="profile_phone">
                </div>
                <button type="submit" class="btn btn-primary btn-block" id="sign-in-button">인증번호 받기</button>
			</form>
            
            <form id="verification-code-form" action="#">
				<hr class="my-4">
				<div class="form-group">
                    <p>핸드폰 인증 번호</p>
                    <input type="text" class="form-control" id="profile_phone_v" name="profile_phone_v">
                </div>
                <button type="submit" class="btn btn-primary btn-block">핸드폰 번호 인증하기</button>
			</form>
            <!--<form action="/users/info" method="post">
                <div class="form-group">
                    <label for="join_nickname">닉네임</label>
                    <input type="text" class="form-control" name="join_nickname" id="join_nickname" maxlength="18" required>
                </div>
                <hr class="my-4">
                <button type="submit" class="btn btn-primary btn-block">프로필 닉네임 수정하기</button>
			</form>-->
			<div class="mt-3 text-center small">
				<a class="mx-2 text-muted" href="/">홈으로</a>
			</div>
		</div>

		<!-- Bootstrap core JavaScript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script src="../js/jquery-3.3.1.min.js"></script>
		<script src="../js/bootstrap.bundle.min.js"></script>
		<script src="https://www.gstatic.com/firebasejs/5.7.3/firebase.js"></script>
        <script src="https://www.gstatic.com/firebasejs/5.5.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/5.5.2/firebase-auth.js"></script>
        <script>
            var config = {
                apiKey: "AIzaSyBK-JY3h8Hj4dH-qTJtTmmiew4zE8U9hC4",
                authDomain: "foregg-8e50f.firebaseapp.com",
                databaseURL: "https://foregg-8e50f.firebaseio.com",
                projectId: "foregg-8e50f",
                storageBucket: "foregg-8e50f.appspot.com",
                messagingSenderId: "530431911120"
            };
            firebase.initializeApp(config);
        </script>
        <script type="text/javascript">
            window.onload = function() {
                // Listening for auth state changes.
                firebase.auth().onAuthStateChanged(function(user) {
                    if (user) {
                        // User is signed in.
                        var uid = user.uid;
                        var email = user.email;
                        var phone = user.phone;
                    }
                });
                
    // [START appVerifier]
    window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('sign-in-button', {
      'size': 'invisible',
      'callback': function(response) {
        // reCAPTCHA solved, allow signInWithPhoneNumber.
        onSignInSubmit();
      }
    });
    // [END appVerifier]
    recaptchaVerifier.render().then(function(widgetId) {
      window.recaptchaWidgetId = widgetId;
      updateSignInButtonUI();
    });
  };
            
            function onSignInSubmit() {console.log("onSignInSubmit");
    if (isPhoneNumberValid()) {
      window.signingIn = true;
      updateSignInButtonUI();
      var phoneNumber = getPhoneNumberFromUserInput();
      var appVerifier = window.recaptchaVerifier;
      firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier)
          .then(function (confirmationResult) {
            // SMS sent. Prompt user to type the code from the message, then sign the
            // user in with confirmationResult.confirm(code).
            window.confirmationResult = confirmationResult;
            window.signingIn = false;
            updateSignInButtonUI();
            updateVerificationCodeFormUI();
            updateVerifyCodeButtonUI();
            updateSignInFormUI();
          }).catch(function (error) {
            // Error; SMS not sent
            console.error('Error during signInWithPhoneNumber', error);
            window.alert('Error during signInWithPhoneNumber:\n\n'
                + error.code + '\n\n' + error.message);
            window.signingIn = false;
            updateSignInFormUI();
            updateSignInButtonUI();
          });
    }
  }
            
        </script>
	</body>
</html>
